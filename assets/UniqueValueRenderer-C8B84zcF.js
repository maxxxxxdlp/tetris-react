import{e as l,y as a,bp as G,l6 as se,c as w,bt as me,bo as ie,l7 as le,q as U,l8 as oe,l9 as ne,bq as f,cD as T,la as ae,kM as O,i as P,b0 as L,eW as W,c7 as re,lb as ue,lc as X,ld as pe,g_ as ve,hS as de,bF as Y,le as M,cF as be,a as ge,ac as H,hK as Ve,cf as Ie,lf as _e,lg as Se,A,lh as we}from"./index-Bv0Hohk0.js";import{m as qe}from"./diffUtils-D_LMLEpD.js";var J;let V=J=class extends G{constructor(e){super(e),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new J({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const e=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${e}`}};l([a({type:String,json:{write:!0}})],V.prototype,"description",void 0),l([a({type:String,json:{write:!0}})],V.prototype,"label",void 0),l([a({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],V.prototype,"minValue",void 0),l([a({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],V.prototype,"maxValue",void 0),l([a(se)],V.prototype,"symbol",void 0),V=J=l([w("esri.renderers.support.ClassBreakInfo")],V);const R=V;var Z;const he="log",D="percent-of-total",C="field",N=new me({esriNormalizeByLog:he,esriNormalizeByPercentOfTotal:D,esriNormalizeByField:C}),xe=ie(R);let p=Z=class extends le(de){constructor(e){super(e),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(e,t,s){if(!Array.isArray(e))return;let i=t.minValue;return e.map(o=>{const n=new R;return n.read(o,s),n.minValue==null&&(n.minValue=i),n.maxValue==null&&(n.maxValue=n.minValue),i=n.maxValue,n})}writeClassBreakInfos(e,t,s,i){const o=e.map(n=>n.write({},i));this._areClassBreaksConsecutive()&&o.forEach(n=>delete n.classMinValue),t[s]=o}castField(e){return e==null?e:typeof e=="function"?(U.getLogger(this).error(".field: field must be a string value"),null):oe(e)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let e=this._get("normalizationType");const t=!!this.normalizationField,s=this.normalizationTotal!=null;return t||s?(e=t&&C||s&&D||null,t&&s&&U.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):e!==C&&e!==D||(e=null),e}set normalizationType(e){this._set("normalizationType",e)}addClassBreakInfo(e,t,s){let i=null;i=typeof e=="number"?new R({minValue:e,maxValue:t,symbol:ne(s)}):xe(f(e)),this.classBreakInfos.push(i),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(e,t){const s=this.classBreakInfos.length;for(let i=0;i<s;i++){const o=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(o[0]===e&&o[1]===t){this.classBreakInfos.splice(i,1);break}}}getBreakIndex(e,t){return this.valueExpression&&(t==null?void 0:t.arcade)==null&&U.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(e,t):this._getBreakIndexForField(e)}async getClassBreakInfo(e,t){let s=t;this.valueExpression&&(t==null?void 0:t.arcade)==null&&(s={...s,arcade:await T()});const i=this.getBreakIndex(e,s);return i!==-1?this.classBreakInfos[i]:null}getSymbol(e,t){if(this.valueExpression&&(t==null?void 0:t.arcade)==null)return void U.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const s=this.getBreakIndex(e,t);return s>-1?this.classBreakInfos[s].symbol:this.defaultSymbol}async getSymbolAsync(e,t){let s=t;if(this.valueExpression&&(t==null?void 0:t.arcade)==null){const o=await T(),{arcadeUtils:n}=o;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),s={...s,arcade:o}}const i=this.getBreakIndex(e,s);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}getSymbols(){const e=[];return this.classBreakInfos.forEach(t=>{t.symbol&&e.push(t.symbol)}),this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,t)=>e+t.getAttributeHash(),"")}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),s=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${e}.${t}.${this.classBreakInfos.reduce((i,o)=>i+o.getMeshHash(),"")}.${s}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){var e,t;return new Z({field:this.field,backgroundFillSymbol:(e=this.backgroundFillSymbol)==null?void 0:e.clone(),defaultLabel:this.defaultLabel,defaultSymbol:(t=this.defaultSymbol)==null?void 0:t.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:f(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:f(this.visualVariables),legendOptions:f(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}async collectRequiredFields(e,t){const s=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(s)}async collectSymbolFields(e,t){const s=[...this.getSymbols().map(i=>i.collectRequiredFields(e,t)),ae(e,t,this.valueExpression)];O(e,t,this.field),O(e,t,this.normalizationField),await Promise.all(s)}_getBreakIndexForExpression(e,t){const{viewingMode:s,scale:i,spatialReference:o,arcade:n,timeZone:r}=t??{},{valueExpression:h}=this;let d=this._compiledValueExpression.valueExpression===h?this._compiledValueExpression.compiledFunction:null;const c=n.arcadeUtils;if(!d){const y=c.createSyntaxTree(h);d=c.createFunction(y),this._compiledValueExpression.compiledFunction=d}this._compiledValueExpression.valueExpression=h;const m=c.executeFunction(d,c.createExecContext(e,c.getViewInfo({viewingMode:s,scale:i,spatialReference:o}),r));return this._getBreakIndexfromInfos(m)}_getBreakIndexForField(e){const t=this.field,s=e.attributes,i=this.normalizationType;let o=parseFloat(s[t]);if(i){const n=this.normalizationTotal,r=parseFloat(this.normalizationField?s[this.normalizationField]:void 0);if(i===he)o=Math.log(o)*Math.LOG10E;else if(i!==D||n==null||isNaN(n)){if(i===C&&!isNaN(r)){if(isNaN(o)||isNaN(r))return-1;o/=r}}else o=o/n*100}return this._getBreakIndexfromInfos(o)}_getBreakIndexfromInfos(e){const t=this.isMaxInclusive;if(e!=null&&typeof e=="number"&&!isNaN(e))for(let s=0;s<this.classBreakInfos.length;s++){const i=[this.classBreakInfos[s].minValue,this.classBreakInfos[s].maxValue];if(i[0]<=e&&(t?e<=i[1]:e<i[1]))return s}return-1}_areClassBreaksConsecutive(){const e=this.classBreakInfos,t=e.length;for(let s=1;s<t;s++)if(e[s-1].maxValue!==e[s].minValue)return!1;return!0}};l([a(ue)],p.prototype,"backgroundFillSymbol",void 0),l([a({type:[R]})],p.prototype,"classBreakInfos",void 0),l([P("classBreakInfos")],p.prototype,"readClassBreakInfos",null),l([L("classBreakInfos")],p.prototype,"writeClassBreakInfos",null),l([a({type:String,json:{write:!0}})],p.prototype,"defaultLabel",void 0),l([a(X)],p.prototype,"defaultSymbol",void 0),l([a({type:String,json:{write:!0}})],p.prototype,"field",void 0),l([W("field")],p.prototype,"castField",null),l([a({type:Boolean})],p.prototype,"isMaxInclusive",void 0),l([a({type:pe,json:{write:!0}})],p.prototype,"legendOptions",void 0),l([a({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],p.prototype,"minValue",null),l([a({type:String,json:{write:!0}})],p.prototype,"normalizationField",void 0),l([a({type:Number,cast:e=>ve(e),json:{write:!0}})],p.prototype,"normalizationTotal",void 0),l([a({type:N.apiValues,value:null,json:{type:N.jsonValues,read:N.read,write:N.write}})],p.prototype,"normalizationType",null),l([re({classBreaks:"class-breaks"})],p.prototype,"type",void 0),l([a({type:String,json:{write:!0}})],p.prototype,"valueExpression",void 0),l([a({type:String,json:{write:!0}})],p.prototype,"valueExpressionTitle",void 0),p=Z=l([w("esri.renderers.ClassBreaksRenderer")],p);const Be=p;let q=class extends Y(G){constructor(t){super(t),this.value=null,this.value2=null,this.value3=null}};l([a(M)],q.prototype,"value",void 0),l([a(M)],q.prototype,"value2",void 0),l([a(M)],q.prototype,"value3",void 0),q=l([w("esri.renderers.support.UniqueValue")],q);const x=q;let I=class extends Y(G){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(t){if(t==null)return null;const s=typeof(t=Array.isArray(t)?t:[t])[0];return s==="string"||s==="number"?t.map(i=>new x({value:i})):s==="object"?t[0]instanceof x?t:t.map(i=>new x(i)):null}};l([a({type:String,json:{write:!0}})],I.prototype,"description",void 0),l([a({type:String,json:{write:!0}})],I.prototype,"label",void 0),l([a(X)],I.prototype,"symbol",void 0),l([a({type:[x],json:{type:[[String]],read:{reader:e=>e?e.map(t=>new x({value:t[0],value2:t[1],value3:t[2]})):null},write:{writer:(e,t)=>{const s=[];for(const i of e){const o=[i.value,i.value2,i.value3].filter(be).map(n=>n.toString());s.push(o)}t.values=s}}}})],I.prototype,"values",void 0),l([W("values")],I.prototype,"castValues",null),I=l([w("esri.renderers.support.UniqueValueClass")],I);const ce=I;let $=class extends Y(G){constructor(e){super(e),this.heading=null,this.classes=null}};l([a({type:String,json:{write:!0}})],$.prototype,"heading",void 0),l([a({type:[ce],json:{write:!0}})],$.prototype,"classes",void 0),$=l([w("esri.renderers.support.UniqueValueGroup")],$);const K=$;var Q;let S=Q=class extends G{constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new Q({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){var t;const e=JSON.stringify((t=this.symbol)==null?void 0:t.toJSON());return`${this.value}.${e}`}};l([a({type:String,json:{write:!0}})],S.prototype,"description",void 0),l([a({type:String,json:{write:!0}})],S.prototype,"label",void 0),l([a(se)],S.prototype,"symbol",void 0),l([a(M)],S.prototype,"value",void 0),S=Q=l([w("esri.renderers.support.UniqueValueInfo")],S);const j=S;var B;const fe="esri.renderers.UniqueValueRenderer",g=()=>U.getLogger(fe),ee="uvInfos-watcher",te="uvGroups-watcher",Fe=",",ke=ie(j);function Ee(e){const{field1:t,field2:s,field3:i,fieldDelimiter:o,uniqueValueInfos:n,valueExpression:r}=e,h=!(!t||!s);return[{classes:(n??[]).map(d=>{var _;const{symbol:c,label:m,value:y,description:v}=d,[F,k,E]=h?((_=y==null?void 0:y.toString())==null?void 0:_.split(o||""))||[]:[y],b=[];return(t||r)&&b.push(F),s&&b.push(k),i&&b.push(E),{symbol:c,label:m,values:[b],description:v}})}]}let u=B=class extends le(de){constructor(e){super(e),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(t,s){if(!t&&!s)return;if(!t||!s)return{type:"complete",oldValue:t,newValue:s};let i=!1;const o={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let n=0;n<s.length;n++){const r=t.find(h=>h.value===s[n].value);r?qe(r,s[n])?(o.changed.push({type:"complete",oldValue:r,newValue:s[n]}),i=!0):o.unchanged.push({oldValue:r,newValue:s[n]}):(o.added.push(s[n]),i=!0)}for(let n=0;n<t.length;n++)s.find(r=>r.value===t[n].value)||(o.removed.push(t[n]),i=!0);return i?o:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(e){this._set("field",e),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(e){return e==null||typeof e=="function"?e:oe(e)}writeField(e,t,s,i){typeof e=="string"?t[s]=e:i!=null&&i.messages?i.messages.push(new ge("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):g().error(".field: cannot write field to JSON since it's not a string value")}set field2(e){this._set("field2",e),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(e){this._set("field3",e),this._updateUniqueValues()}set valueExpression(e){this._set("valueExpression",e),this._updateUniqueValues()}set defaultSymbol(e){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",e)}set fieldDelimiter(e){this._set("fieldDelimiter",e),this._updateUniqueValues()}readPortal(e,t,s){return s.portal||H.getDefault()}readStyleOrigin(e,t,s){if(t.styleName)return Object.freeze({styleName:t.styleName});if(t.styleUrl){const i=Ve(t.styleUrl,s);return Object.freeze({styleUrl:i})}}writeStyleOrigin(e,t,s,i){e.styleName?t.styleName=e.styleName:e.styleUrl&&(t.styleUrl=Ie(e.styleUrl,i))}set uniqueValueGroups(e){this.styleOrigin?g().error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",e),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(e){this.styleOrigin?g().error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(e,t){var i;if(this.styleOrigin)return void g().error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let s;s=typeof e=="object"?ke(e):new j({value:e,symbol:ne(t)}),(i=this.uniqueValueInfos)==null||i.push(s),this._valueInfoMap[s.value]=s,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(e){if(this.styleOrigin)return void g().error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const t=this.uniqueValueInfos;if(t)for(let s=0;s<t.length;s++){const i=t[s];if(String(i.value)===String(e)){delete this._valueInfoMap[e],t.splice(s,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(e,t){let s=t;return this.valueExpression&&(t==null?void 0:t.arcade)==null&&(s={...s,arcade:await T()}),this._getUniqueValueInfo(e,s)}getSymbol(e,t){if(this.valueExpression&&(t==null?void 0:t.arcade)==null)return void g().error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const s=this._getUniqueValueInfo(e,t);return(s==null?void 0:s.symbol)||this.defaultSymbol}async getSymbolAsync(e,t){let s=t;if(this.valueExpression&&(s==null?void 0:s.arcade)==null){const o=await T(),{arcadeUtils:n}=o;n.hasGeometryOperations(this.valueExpression)&&await n.enableGeometryOperations(),s={...s,arcade:o}}const i=this._getUniqueValueInfo(e,s);return(i==null?void 0:i.symbol)||this.defaultSymbol}getSymbols(){const e=[];for(const t of this.uniqueValueInfos??[])t.symbol&&e.push(t.symbol);return this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,t)=>e+t.getAttributeHash(),"")}getMeshHash(){var i;const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),s=(i=this.uniqueValueInfos)==null?void 0:i.reduce((o,n)=>o+n.getMeshHash(),"");return`${e}.${t}.${s}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const e=new B({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:f(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:f(this.visualVariables),legendOptions:f(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:f(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(e._isDefaultSymbolDerived=!0),e._set("portal",this.portal);const t=f(this.uniqueValueInfos),s=f(this.uniqueValueGroups);return this.styleOrigin&&(e._set("styleOrigin",Object.freeze(f(this.styleOrigin))),Object.freeze(t),Object.freeze(s)),e._set("uniqueValueInfos",t),e._updateValueInfoMap(),e._set("uniqueValueGroups",s),e._isInfosSource=this._isInfosSource,e._watchUniqueValueInfosAndGroups(),e}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(e,t){const s=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(s)}async collectSymbolFields(e,t){const s=[...this.getSymbols().map(i=>i.collectRequiredFields(e,t)),ae(e,t,this.valueExpression)];O(e,t,this.field),O(e,t,this.field2),O(e,t,this.field3),await Promise.all(s)}populateFromStyle(){return _e(this.styleOrigin,{portal:this.portal}).then(e=>{var s;const t=[];return this._valueInfoMap={},e&&e.data&&Array.isArray(e.data.items)&&e.data.items.forEach(i=>{const o=new Se({styleUrl:e.styleUrl,styleName:e.styleName,portal:this.portal,name:i.name});this.defaultSymbol||i.name!==e.data.defaultItem||(this.defaultSymbol=o,this._isDefaultSymbolDerived=!0);const n=new j({value:i.name,symbol:o});t.push(n),this._valueInfoMap[i.name]=n}),this._set("uniqueValueInfos",Object.freeze(t)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&((s=this.uniqueValueInfos)!=null&&s.length)&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this})}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",Fe)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:e}=this;if(e)for(const t of e)this._valueInfoMap[t.value+""]=t}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(ee);const{uniqueValueInfos:e}=this;if(e){const t=[];for(const s of e)t.push(A(()=>({symbol:s.symbol,value:s.value,label:s.label,description:s.description}),(i,o)=>{i!==o&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)},{sync:!0}));this.addHandles(t,ee)}}_watchUniqueValueGroups(){this.removeHandles(te);const{uniqueValueGroups:e}=this;if(e){const t=[];for(const s of e){t.push(A(()=>({classes:s.classes}),(i,o)=>{i!==o&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}));for(const i of s.classes??[])t.push(A(()=>({symbol:i.symbol,values:i.values,label:i.label,description:i.description}),(o,n)=>{o!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}))}this.addHandles(t,te)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const e=[],{field:t,field2:s,field3:i,fieldDelimiter:o,uniqueValueGroups:n,valueExpression:r}=this;if(!t&&!r)return this._set("uniqueValueInfos",e),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const h=!(!t||!s);for(const d of n)for(const c of d.classes??[]){const{symbol:m,label:y,values:v,description:F}=c;for(const k of v??[]){const{value:E,value2:b,value3:_}=k,z=[E];s&&z.push(b),i&&z.push(_);const ye=h?z.join(o||""):z[0];e.push(new j({symbol:m,label:y,value:ye,description:F}))}}this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(e=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:t,field2:s,valueExpression:i,fieldDelimiter:o,uniqueValueInfos:n}=this;if(!t&&!i||!n.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const r=!(!t||!s),h=n.map(c=>{var _;const{symbol:m,label:y,value:v,description:F}=c,[k,E,b]=r?((_=v==null?void 0:v.toString())==null?void 0:_.split(o||""))||[]:[v];return new ce({symbol:m,label:y,description:F,values:[new x({value:k,value2:E,value3:b})]})}),d=[new K({classes:h})];e&&Object.freeze(d),this._set("uniqueValueGroups",d),this._watchUniqueValueGroups()}_getUniqueValueInfo(e,t){return this.valueExpression?this._getUnqiueValueInfoForExpression(e,t):this._getUnqiueValueInfoForFields(e)}_getUnqiueValueInfoForExpression(e,t){const{viewingMode:s,scale:i,spatialReference:o,arcade:n,timeZone:r}=t??{};let h=this._cache.compiledFunc;const d=n.arcadeUtils;if(!h){const m=d.createSyntaxTree(this.valueExpression);h=d.createFunction(m),this._cache.compiledFunc=h}const c=d.executeFunction(h,d.createExecContext(e,d.getViewInfo({viewingMode:s,scale:i,spatialReference:o}),r));return this._valueInfoMap[c+""]}_getUnqiueValueInfoForFields(e){const t=this.field,s=e.attributes;let i;if(typeof t!="function"&&this.field2){const o=this.field2,n=this.field3,r=[];t&&r.push(s[t]),o&&r.push(s[o]),n&&r.push(s[n]),i=r.join(this.fieldDelimiter||"")}else typeof t=="function"?i=t(e):t&&(i=s[t]);return this._valueInfoMap[i+""]}static fromPortalStyle(e,t){const s=new B(t==null?void 0:t.properties);s._set("styleOrigin",Object.freeze({styleName:e})),s._set("portal",(t==null?void 0:t.portal)||H.getDefault());const i=s.populateFromStyle();return i.catch(o=>{g().error(`#fromPortalStyle('${e}'[, ...])`,"Failed to create unique value renderer from style name",o)}),i}static fromStyleUrl(e,t){const s=new B(t==null?void 0:t.properties);s._set("styleOrigin",Object.freeze({styleUrl:e}));const i=s.populateFromStyle();return i.catch(o=>{g().error(`#fromStyleUrl('${e}'[, ...])`,"Failed to create unique value renderer from style URL",o)}),i}};l([a({readOnly:!0})],u.prototype,"_cache",null),l([re({uniqueValue:"unique-value"})],u.prototype,"type",void 0),l([a(ue)],u.prototype,"backgroundFillSymbol",void 0),l([a({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],u.prototype,"field",null),l([W("field")],u.prototype,"castField",null),l([L("field")],u.prototype,"writeField",null),l([a({type:String,value:null,json:{write:!0}})],u.prototype,"field2",null),l([a({type:String,value:null,json:{write:!0}})],u.prototype,"field3",null),l([a({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],u.prototype,"orderByClassesEnabled",void 0),l([a({type:String,value:null,json:{write:!0}})],u.prototype,"valueExpression",null),l([a({type:String,json:{write:!0}})],u.prototype,"valueExpressionTitle",void 0),l([a({type:pe,json:{write:!0}})],u.prototype,"legendOptions",void 0),l([a({type:String,json:{write:!0}})],u.prototype,"defaultLabel",void 0),l([a(we({...X},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],u.prototype,"defaultSymbol",null),l([a({type:String,value:null,json:{write:!0}})],u.prototype,"fieldDelimiter",null),l([a({type:H,readOnly:!0})],u.prototype,"portal",void 0),l([P("portal",["styleName"])],u.prototype,"readPortal",null),l([a({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],u.prototype,"styleOrigin",void 0),l([P("styleOrigin",["styleName","styleUrl"])],u.prototype,"readStyleOrigin",null),l([L("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],u.prototype,"writeStyleOrigin",null),l([a({type:[K],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(e,t,s)=>(t.uniqueValueGroups||Ee(t)).map(i=>K.fromJSON(i,s))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],u.prototype,"uniqueValueGroups",null),l([a({type:[j],json:{read:!1,write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],u.prototype,"uniqueValueInfos",null),u=B=l([w(fe)],u);const Ge=u;export{Ge as A,R as a,j as n,Be as w};
