import{gD as E,gE as _,gF as x,gx as i,gG as c,gH as A,e0 as d,d5 as g,gI as C,Z as I,t as h}from"./index-Bv0Hohk0.js";function L(e,u,t,r){if(u==null||r==null)return!1;const s=_(u,r,m);if(s.projector===x)return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],!0;if(s.projector==null)return!1;const{source:n,dest:a}=s;if(a.spatialReferenceId===i.WEB_MERCATOR){const o=c[n.spatialReferenceId][i.WGS84];return o!=null&&(o(e,0,f,0),A(f,0,t,0),t[3]=p(f[1],e[2],e[3],d.radius),!0)}if(n.spatialReferenceId!==i.WGS84&&n.spatialReferenceId!==i.CGCS2000||a.spatialReferenceId!==i.PLATE_CARREE){s.projector(e,0,t,0);const o=n.metersPerUnit??1,l=a.metersPerUnit??1;t[3]=e[3]*o/l}else{const o=c[n.spatialReferenceId][i.SPHERICAL_ECEF],l=c[i.SPHERICAL_ECEF][i.PLATE_CARREE];let R=e[3];o!=null&&l!=null&&(R=p(e[1],e[2],e[3],d.radius)),s.projector(e,0,t,0),t[3]=R}return!0}function p(e,u,t,r){const s=r+u;if(s<r/2||t>s)return Number.MAX_VALUE;const n=Math.abs(P*e)+Math.asin(t/s);return n>=Math.PI/2?Number.MAX_VALUE:t/Math.cos(n)}const f=g(),m=E(),P=C(1);class S{constructor(u,t){this._textureRep=u,this.loadPromise=null,this._disposed=!1;const r=this._textureRep.acquire(t);I(r)?(r.then(s=>{this._disposed?h(s):this._textureRef=s}),this.loadPromise=r):this._textureRef=r}dispose(){this._textureRef=h(this._textureRef),this._disposed=!0}get glTexture(){return this._textureRef!=null?this._textureRef.glTexture:null}}export{L as a,S as s};
